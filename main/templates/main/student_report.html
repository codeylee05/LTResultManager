{% extends "main/base.html" %}
{% load static %}
{% block title %}Student Report Term 2{% endblock %}

{% block content %}
<div style="display: flex; justify-content: space-between; align-items: flex-start; margin: 30px 40px;">

    <div style="display: flex;">

        {% if student.profile_pic %}
        <img src="{{ student.profile_pic.url }}" alt="Profile Picture"
            style="width: 150px; height: 150px; object-fit: cover; border-radius: 10px; margin-right: 30px;">
        {% else %}
        <div
            style="width: 150px; height: 150px; background: #ddd; border-radius: 10px; margin-right: 30px; display: flex; align-items: center; justify-content: center;">
            <span>No Photo</span>
        </div>
        {% endif %}

        <div>
            <h2>{{ student.first_name }} {{ student.surname }}</h2>
            <p><strong>Grade:</strong> {{ student.grade }}</p>
            <p><strong>Date of Birth:</strong> {{ student.dob }}</p>
            <p><strong>Class Teacher:</strong> {{ student.class_teacher.name }}</p>

            <div style="display: flex; flex-direction: column; gap: 10px; margin-top: 15px;">
                <button class="btn btn-outline-primary" disabled>Previous Results</button>
                <button class="btn btn-outline-primary" disabled>Previous Reports</button>
                <button class="btn btn-outline-success" disabled>Term 2 Results</button>

            </div>
        </div>
    </div>

    <div>
        {% if term_report %}
        <div style="width: 100%;">
            <div class="report-wrapper">
                <div class="report-card">
                    <div class="report-logo">
                        <img src="{% static 'main/images/ship_report_header.jpg' %}" alt="School Logo"
                            class="report-logo-img">
                    </div>
                    <div class="report-title">
                        <h2>Term 2 Report Card</h2>
                        <p class="year">Academic Year: 2025</p>
                    </div>

                    <div class="student-info">
                        <p><strong>Student Name:</strong> {{ student.first_name }} {{ student.surname }}</p>
                        <p><strong>Class:</strong> {{ student.grade }}</p>
                        <p><strong>Days Absent:</strong> {{ term_report.days_absent }}</p>
                        <p><strong>School Reopens:</strong> 22/07/2025</p>
                    </div>

                    <table class="report-table">
                        <thead>
                            <tr>
                                <th>Subject</th>
                                <th>Total Marks</th>
                                <th>Marks Obtained</th>
                                <th>Grade</th>
                                <th>Remarks</th>
                                <th>Class Average</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for grade in subject_grades %}
                            <tr>
                                <td>{{ grade.subject.name }}</td>
                                <td>{{ grade.total_marks }}</td>
                                <td>{{ grade.marks_obtained }}</td>
                                <td>{{ grade.grade }}</td>
                                <td>{{ grade.remarks }}</td>
                                <td>{{ grade.class_average }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>

                    <!-- Replace the summary block with dynamic values -->
                    <div class="summary">
                        <p><strong>Total Marks Obtained:</strong> {{ term_report.total_marks_obtained }}</p>
                        <p><strong>Final Percentage:</strong> {{ term_report.final_percentage }}%</p>
                        <p><strong>Overall Grade:</strong> {{ term_report.overall_grade }}</p>
                    </div>

                    <table class="grading-scale">
                        <thead>
                            <tr>
                                <th colspan="2">Grading Scale</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>0 – 39</td>
                                <td>U (Ungraded)</td>
                            </tr>
                            <tr>
                                <td>40 – 49</td>
                                <td>E</td>
                            </tr>
                            <tr>
                                <td>50 – 59</td>
                                <td>D</td>
                            </tr>
                            <tr>
                                <td>60 – 69</td>
                                <td>C</td>
                            </tr>
                            <tr>
                                <td>70 – 79</td>
                                <td>B</td>
                            </tr>
                            <tr>
                                <td>80 – 89</td>
                                <td>A</td>
                            </tr>
                            <tr>
                                <td>90 – 100</td>
                                <td>A+</td>
                            </tr>
                        </tbody>
                    </table>

                    <!-- Replace the static comment block -->
                    <div class="comment">
                        <p><strong>Comment:</strong> {{ term_report.comment }}</p>
                    </div>

                    <div class="signatures">
                        <div class="signature-box">
                            <p class="title">Class Teacher</p>
                            <div class="sig-box"></div>
                            <p class="name">{{ student.class_teacher.name }}</p>
                        </div>
                        <div class="signature-box">
                            <p class="title">Head of School</p>
                            <div class="sig-box"></div>
                            <p class="name">Mr Michael</p>
                        </div>
                        <div class="signature-box">
                            <p class="title">Academic Head</p>
                            <div class="sig-box"></div>
                            <p class="name">Ms Sharon</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        {% else %}
        <div class="alert alert-warning" role="alert"
            style="margin-right: 200px; margin-top: 20px; text-align: center;">
            No Term 2 Report available yet for this student.
        </div>
        {% endif %}
    </div>




</div>
{% endblock %}